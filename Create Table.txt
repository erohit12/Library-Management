DROP TABLE Enrol;
DROP TABLE Borrow;
DROP TABLE Class;
DROP TABLE Loan;
DROP TABLE Res;
DROP TABLE MEMBER;
DROP TABLE Copies;

CREATE TABLE Res  
( Resource_ID varchar2(10),  
  Resource_Type varchar2(10) NOT NULL,  
  Resource_Title varchar2(250) NOT NULL,
  Total_Copies number(10) NOT NULL,
  Loan_Period number(10) NOT NULL,
  Floor_No number(10) NOT NULL,
  Shelf_No varchar2(20) NOT NULL,
  Author varchar2(250),
  Publisher varchar2(250),
  Publish_Date DATE,
  Edit number(10),
  Director varchar2(250),
  Release_Date DATE,
  Artist varchar2(250),
  CONSTRAINT Res_pk PRIMARY KEY (Resource_ID)  
);

CREATE TABLE Loan  
( Loan_ID varchar2(10),  
  Return_Date DATE,
  Date_Paid DATE,
  Amount_Paid number(20),
  CONSTRAINT Loan_pk PRIMARY KEY (Loan_ID)  
);

CREATE TABLE Class  
( Class_No number(10),
  Class_Name varchar2(250) NOT NULL,
  CONSTRAINT Class_pk PRIMARY KEY (Class_No)  
); 

CREATE TABLE Copies
( Member_Type varchar2(20),
  Copies_Allowed number(10),
  CONSTRAINT Copies_pk PRIMARY KEY (Member_Type)
);

CREATE TABLE MEMBER
(
 Member_ID number(30),
 Member_Type varchar2(20) NOT NULL,
 Member_Name varchar2(250) NOT NULL,
 Member_Email varchar2(1000) NOT NULL,
 Expiry_Date DATE NOT NULL,
 CONSTRAINT Mem_pk PRIMARY KEY (Member_ID),
 CONSTRAINT Mem_fk FOREIGN KEY (Member_Type) REFERENCES Copies(Member_Type)
);

CREATE TABLE Borrow
( Member_ID number(30),
  Resource_ID varchar2(10),
  Due_Date DATE,
  Loan_ID varchar2(10),
  CONSTRAINT Borrow_pk PRIMARY KEY (Member_ID, Resource_ID, Due_Date),
  CONSTRAINT Borrow_fk1 FOREIGN KEY (Member_ID) REFERENCES MEMBER(Member_ID),
  CONSTRAINT Borrow_fk2 FOREIGN KEY (Resource_ID) REFERENCES Res(Resource_ID),
  CONSTRAINT Borrow_fk3 FOREIGN KEY (Loan_ID) REFERENCES Loan(Loan_ID)
);

CREATE TABLE Enrol
( Member_ID number(30),
  Class_No number(10),
  Enrol_Date DATE NOT NULL,
  CONSTRAINT Enrol_pk PRIMARY KEY (Member_ID, Class_No),
  CONSTRAINT Enrol_fk1 FOREIGN KEY (Member_ID) REFERENCES MEMBER(Member_ID),
  CONSTRAINT Enrol_fk2 FOREIGN KEY (Class_No) REFERENCES Class(Class_No)
);
